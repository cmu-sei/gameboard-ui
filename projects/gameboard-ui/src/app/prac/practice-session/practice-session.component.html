<div class="container">
  <div *ngIf="spec$ | async as spec; else loading">
    <h2>{{spec.name}}</h2>
    <span class="lead">{{spec.gameName}}</span>
    <p>{{spec.description}}</p>

    <div *ngIf="user$ | async as user" class="text-center my-5">
      <ng-container
        *ngTemplateOutlet="(activeOtherChallenge ? activeOtherChallengeButton : standardConfirm); context: { spec: spec }"></ng-container>
    </div>

    <app-login *ngIf="unauthed"></app-login>
    <markdown [data]="spec.text"></markdown>
  </div>

  <app-error-div [errors]="errors"></app-error-div>
</div>

<ng-template #loading>
  <div class="text-center">
    <app-spinner></app-spinner>
  </div>
</ng-template>

<ng-template #standardConfirm let-spec="spec">
  <app-confirm-button btnClass="btn btn-lg btn-info px-4" (confirm)="play(spec)" class="d-block">
    <span>Start Practice Session</span>
  </app-confirm-button>
</ng-template>

<ng-template #activeOtherChallengeButton let-spec="spec">
  <button type="button" class="btn btn-lg btn-warning"
    (click)="handleStartNewChallengeClick(spec, activeOtherChallenge!)">
    Stop your current challenge and play this one instead
  </button>
</ng-template>
