<div class="practice-mode-by-user-component" *ngIf="results; else loading">
    <div *ngIf="results && results.records.length; else noRecords" class="results">
        <table class="report-table table-hover gameboard-report">
            <col span="2">
            <colgroup span="6"></colgroup>
            <!-- <colgroup span="3"></colgroup> -->

            <thead class="thead-light">
                <tr class="headers super-headers-row">
                    <th scope="col" colSpan="2"></th>
                    <th scope="col" colSpan="6" class="group-header">Attempts</th>
                </tr>
            </thead>

            <tbody>
                <tr class="headers headers-row">
                    <td>Player</td>
                    <td>Challenge</td>
                    <td>Total</td>
                    <td>Most Recent</td>
                    <td>Best Score</td>
                    <td>Date of Best Score</td>
                    <td>Best Score Time</td>
                    <td>Partial/Full Correct</td>
                </tr>

                <tr class="data-row" *ngFor="let record of results.records">
                    <!--PLAYER-->
                    <td>
                        <div class="d-flex align-items-center">
                            <div class="player-info flex-grow-1">
                                <p class="player-name m-0">{{record.user.name}}</p>
                            </div>
                        </div>
                    </td>
                    <td>
                        <app-challenge-or-game-field [challengeName]="record.challenge.name"
                            [game]="record.challenge.game"></app-challenge-or-game-field>
                    </td>

                    <!--ATTEMPTS-->
                    <td class="report-field numerical">
                        <p [class.tooltipped-value]="record.attempts.length > 0"
                            (click)="record.attempts.length && showAttemptsSummary(record)">
                            {{ record.attempts.length }}
                        </p>
                    </td>
                    <td class="report-field numerical">
                        <p>{{ (record.attempts | sort: "start":true)[0].start | shortdate }}</p>
                    </td>
                    <td class="report-field numerical">
                        <p *ngIf="record.user.hasScoringAttempt; else noValue">{{ (record.attempts | sort:
                            "score":true)[0].score }}</p>
                    </td>
                    <td class="report-field numerical">
                        <p *ngIf="record.user.hasScoringAttempt; else noValue">
                            {{ (record.attempts | sort: "score":true)[0].start | friendlyDateAndTime }}
                        </p>
                    </td>
                    <td class="report-field numerical">
                        <p *ngIf="record.user.hasScoringAttempt; else noValue">
                            {{ (record.attempts | sort: "score":true)[0].durationMs | msToDuration }}
                        </p>
                    </td>
                    <td class="report-field numerical">
                        <p *ngIf="record.user.hasScoringAttempt; else noValue">
                            {{ (record.attempts | sort: "score":true)[0].partiallyCorrectCount }} /
                            {{ (record.attempts | sort: "score":true)[0].fullyCorrectCount }}
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="pager-container d-flex justify-content-end mt-4">
        <div class="flex-grow-1"></div>
        <app-select-pager [itemCount]="results.paging.itemCount" [pageSize]="results.paging.pageSize"
            (change)="handlePagingChange($event)"></app-select-pager>
    </div>
</div>

<ng-template #loading>
    <div class="page-height d-flex flex-column align-items-center justify-content-center">
        <app-spinner>Loading the report...</app-spinner>
    </div>
</ng-template>

<ng-template #noRecords>
    <app-no-matching-report-records></app-no-matching-report-records>
</ng-template>

<ng-template #noValue>
    <app-report-field-no-value></app-report-field-no-value>
</ng-template>
