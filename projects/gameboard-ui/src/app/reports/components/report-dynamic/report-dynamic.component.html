<div class="report-dynamic-component" *ngIf="report$ | async as report; else loading">
    <nav aria-label="breadcrumb" *ngIf="!isAtReportsRoot" class="d-flex align-items-center">
        <ol class="d-flex m-0 p-0">
            <li><a [routerLink]="'/reports'">Reports</a></li>
            <li class="mx-2">&gt;</li>
            <li>

                <app-report-select [selectedReportKey]="selectedReportKey" (reportSelect)="handleReportSelect($event)"
                    class="mb-2"></app-report-select>
            </li>
        </ol>
    </nav>

    <div class="header-content" *ngIf="reportMetaData">
        <h1>{{report.name}}</h1>
        <h5>{{reportMetaData.runAt | shortdate }} @ {{reportMetaData.runAt | friendlyTime}}</h5>
        <p>{{report.description}}</p>
    </div>
</div>

<div class="report-export d-flex align-items-center mt-5">
    <div class="flex-grow-1">
        <span class="about-filters-link link-button" (click)="handleAboutFiltersClick()">[ About report filters ]</span>
    </div>
    <div class="export-label mr-2">Export to:</div>
    <div class="btn-group mr-2">
        <button class="btn btn-info btn-lg csv-export-button" (click)="handleExportToCsv()" tabindex="0"
            role="button">CSV</button>
        <button class="btn btn-info btn-lg pdf-export-button" (click)="handleExportToPdf()" tabindex="0"
            role="button">PDF</button>
    </div>
    <app-share-button class="d-block mr-2"></app-share-button>
    <button type="button" class="btn btn-outline btn-lg btn-warning mr-2" (click)="handleResetParameters()">
        Reset Filters
    </button>
    <button type="button" class="btn btn-lg btn-success" (click)="handleRunReport()">Run Report</button>
</div>

<!--Note: needs to be outside any ngIfs, or the viewcontainerref can't find this-->
<div class="report-container">
    <ng-template appDynamicReport></ng-template>
</div>

<ng-template #loading>
    <app-spinner></app-spinner>
</ng-template>
