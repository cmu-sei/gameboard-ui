<ng-container *ngIf="scoreboardData; else loading">
    <table *ngIf="scoreboardData.teams.length; else noScore"
        class="table table-striped table-hover gameboard-table w-100">
        <col class="width-5">
        <col>
        <col>
        <col>
        <col>

        <thead class="thead-light">
            <tr class="headers">
                <th scope="col"></th>
                <th scope="col"> {{ scoreboardData.game.isTeamGame ? "Team" : "Player" }} </th>
                <th scope="col">Challenges</th>
                <th scope="col" class="text-center tooltipped-column-header" [tooltip]="cumulativeTimeTooltip">
                    <span class="tooltipped-column-header">Cumulative Time</span>
                </th>
                <th scope="col" class="text-center">Score</th>
            </tr>
        </thead>

        <tbody>
            <tr *ngFor="let teamScore of scoreboardData.teams; index as i" class="data-row cursor-pointer"
                (click)="handleRowClick(teamScore)">
                <td>
                    <div class="team-rank d-flex flex-column justify-content-center align-items-center">
                        {{ teamScore.score.rank }}
                    </div>
                </td>
                <td>
                    <div class="team-container d-flex align-items-center">
                        <ng-container *ngIf="!scoreboardData.game.isTeamGame">
                            <app-player-avatar *ngIf="!scoreboardData.game.isTeamGame" [player]="teamScore.players[0]"
                                class="mr-2"></app-player-avatar>

                            <span class="player-name">
                                {{teamScore.players[0].name}}
                            </span>
                        </ng-container>

                        <div *ngIf="scoreboardData.game.isTeamGame" class="team-names-container ml-2">
                            <h5 class="team-name m-0">{{teamScore.score.teamName}}</h5>
                            <ul class="player-names-list d-flex mt-2">
                                <li *ngFor="let player of teamScore.players" class="mr-2">
                                    <app-player-avatar [player]="player" [showSponsorTooltip]="false" size="tiny"
                                        [tooltip]="player.name + ' // ' + player.sponsor.name"
                                        placement="bottom"></app-player-avatar>
                                </li>
                            </ul>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="challenge-count" *ngIf="teamScore.score.solveCountComplete">
                        <span class="text-success">{{ teamScore.score.solveCountComplete }}</span>
                        <span class="challenge-count-desc"> complete</span>
                    </div>

                    <div class="challenge-count" *ngIf="teamScore.score.solveCountPartial">
                        <span class="text-info">{{ teamScore.score.solveCountPartial }}</span>
                        <span class="challenge-count-desc"> partial</span>
                    </div>

                    <div class="challenge-count"
                        *ngIf="teamScore.score.solveCountPartial + teamScore.score.solveCountComplete < scoreboardData.game.specCount">
                        <span class="text-info">
                            {{ scoreboardData.game.specCount - (teamScore.score.solveCountPartial +
                            teamScore.score.solveCountComplete) }}
                        </span>
                        <span class="challenge-count-desc"> unattempted</span>
                    </div>
                </td>
                <td>
                    <div class="playtime challenge-count text-center">
                        {{ teamScore.score.cumulativeTimeMs | msToDuration }}
                    </div>
                </td>
                <td class="text-center"
                    [tooltip]="teamScore.score.scoreChallenge + ' + ' + (teamScore.score.scoreAutoBonus + teamScore.score.scoreManualBonus) + ' bonus (Click for details)'">
                    <span class="score text-center"
                        [class.text-info]="teamScore.score.scoreOverall != teamScore.score.scoreChallenge">
                        {{ teamScore.score.scoreOverall }}
                    </span>
                </td>
            </tr>
        </tbody>
    </table>
</ng-container>

<ng-template #loading>
    <app-spinner></app-spinner>
</ng-template>

<ng-template #noScore>
    <div class="no-score gray-text text-center">
        No one's scored in this game yet.
    </div>
</ng-template>
